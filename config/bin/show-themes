#!/usr/bin/env bash
# Display available nix-colors themes with color swatches using wofi

THEME_LIST="$HOME/.local/share/nix-config/theme-list"

if [ ! -f "$THEME_LIST" ]; then
    notify-send "Theme Viewer" "Theme list not found. Rebuild your NixOS config."
    exit 1
fi

selected=$(cat "$THEME_LIST" |
flock --nonblock /tmp/.wofi-themes.lock -c "wofi -dmenu -i --allow-markup --cache-file=/dev/null --width 70% --height 50% -p 'Themes'")

if [ -n "$selected" ]; then
    scheme_name=$(echo "$selected" | sed 's/^[â˜… ]* *//; s/ .*//')
    echo -n "$scheme_name" | wl-copy
    notify-send "Theme" "Copied: $scheme_name"
fi
